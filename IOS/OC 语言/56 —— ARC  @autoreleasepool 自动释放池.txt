


@autoreleasepool ×Ô¶¯ÊÍ·Å³Ø
--------------------------------------------------------------------------------------------------------

 ¡ù ×Ô¶¯ÊÍ·Å³ØµÄ½éÉÜ
    ´æÈëµ½×Ô¶¯ÊÍ·Å³ØÖÐ¶ÔÏó£¬ÔÚ×Ô¶¯ÊÍ·Å³Ø±»Ïú»ÙµÄÊ±ºò£¬»á×Ô¶¯µ÷ÓÃ´æ´¢ÔÚ¸Ã×Ô¶¯ÊÍ·Å³ØÖÐµÄËùÓÐ¶ÔÏóµÄrelease·½·¨

    ¿ÉÒÔ½â¾öµÄÎÊÌâ£º
    ½«´´½¨µÄ¶ÔÏó£¬´æÈëµ½×ÔÈ»ÊÍ·Å³ØÖ®ÖÐ£¬¾Í²»ÔÚÐèÒªÊÖ¶¯µÄreleaseÕâ¸ö¶ÔÏóÁË¡£
    ÒòÎª³Ø×ÓÏú»ÙµÄÊ±ºò ¾Í»á×Ô¶¯µÄµ÷ÓÃ³ØÖÐËùÓÐµÄ¶ÔÏóµÄrelase
  
    ×Ô¶¯ÊÍ·Å³ØµÄºÃ´¦£º½«´´½¨µÄ¶ÔÏó´æ´¢µ½×Ô¶¯ÊÍ·Å³ØÖÐ£¬²»ÐèÒªÔÙÐ´release


 ¡ù ÈçºÎ´´½¨×Ô¶¯ÊÍ·Å³Ø
    @autoreleaspool
    {

    }
  

 ¡ù ÈçºÎ½«¶ÔÏó´æ´¢µ½×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ
    ÔÚ×Ô¶¯ÊÍ·Å³ØÖ®ÖÐµ÷ÓÃ¶ÔÏóµÄautorelease·½·¨¡£¾Í»á½«Õâ¸ö¶ÔÏó´æÈëµ½µ±Ç°×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ¡£
    Õâ¸öautorealse·½·¨·µ»ØµÄÊÇ¶ÔÏó±¾Éí¡£ËùÒÔ£¬ÎÒÃÇ¿ÉÒÔÕâÃ´Ð´
    @autoreleaspool
    {
      Person *p1 = [[[Person alloc] init] autorelease];
    }
  
    Õâ¸öÊ±ºò£¬µ±Õâ¸ö×Ô¶¯ÊÍ·Å³ØÖ´ÐÐÍê±ÏÖ®ºó£¬¾Í»áÁ¢¼´ÎªÕâ¸ö×Ô¶¯ÊÍ·Å³ØÖÐµÄ¶ÔÏó·¢ËÍ1ÌõreleaseÏûÏ¢¡£
  
    Ä¿Ç°ÎªÖ¹£¬ÎÒÃÇ¸ÐÊÜµ½µÃautorelaseµÄºÃ´¦£º
    ´´½¨¶ÔÏó£¬µ÷ÓÃ¶ÔÏóµÄautorelase·½·¨ ½«Õâ¸ö¶ÔÏó´æÈëµ½µ±Ç°µÄ×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ¡£

    ÎÒÃÇ¾Í²»ÐèÒªÔÙÈ¥relase ÒòÎª×Ô¶¯ÊÍ·Å³ØÏú»ÙµÄÊ±ºò ¾Í»á×Ô¶¯µÄµ÷ÓÃ³ØÖÐËùÓÐ¶ÔÏóµÄrelase


 ¡ù autoreleaseµÄÓ¦ÓÃ³¡¾°¡£
    1). ´´½¨¶ÔÏó£¬½«¶ÔÏó´æ´¢¶®°¡×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ£¬¾Í²»ÐèÒªÔÙÈ¥ÊÖ¶¯µÄrealse¡£

    2). ÎÒÃÇÒ»°ãÇé¿öÏÂ£¬»áÎªÎÒÃÇµÄÀàÐ´1¸öÀà·½·¨£¬ÓÃÀ´ÈÃÍâ½çµ÷ÓÃÀà·½·¨À´¿ìËÙµÄµÃµ½1¸ö¶ÔÏó¡£
        ¹æ·¶£ºÊ¹ÓÃÀà·½·¨µÃµ½µÄ¶ÔÏó£¬ÒªÇòÕâ¸ö¶ÔÏó¾ÍÒÑ¾­±»autorelease¹ýÁË¡£

        Ìá¹©1¸öÀà·½·¨À´¿ìËÙµÄµÃµ½1¸ö¶ÔÏó¡£
        ¹æ·¶
        a. Õâ¸öÀà·½·¨ÒÔÀàÃû¿ªÍ·¡£ Èç¹ûÃ»ÓÐ²ÎÊý¾ÍÖ±½ÓÊÇÀàÃû Èç¹ûÓÐ²ÎÊý¾ÍÊÇ ÀàÃûWithXX£º
        b. Ê¹ÓÃÀà·½·¨µÃµ½µÄ¶ÔÏó£¬ÒªÇóÕâ¸ö¶ÔÏó¾ÍÒÑ¾­±»autorelease¹ýÁË¡£

        + (instancetype)person
        {
	  return [[[self alloc] init] autotelease];
        }

        ÕâÑù£¬ÎÒÃÇÖ±½Óµ÷ÓÃÀà·½·¨£¬¾Í¿ÉÒÔµÃµ½1¸öÒÑ¾­±»autorelease¹ýµÄ¶ÔÏó¡£
        @autoreleasepool
        {
	  Person *p1 = [Person person];
	  //Õâ¸öp1¶ÔÏóÒÑ¾­±»autorelease¹ýÁË£¬²»ÐèÒªÔÙµ÷ÓÃautorelease
	  //Õâ¸öp1¶ÔÏó¾Í±»´æ´¢µ½µ±Ç°×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ¡£
        }//µ±×Ô¶¯ÊÍ·Å³Ø½áÊø¡£¾Í»áÎª´æ´¢ÔÚÆäÖÐµÄp1¶ÔÏó·ÅËÉreleaseÏûÏ¢¡¢



 ¡ù Êµ¼ÊÉÏAppleµÄ¿ò¼ÜÖÐµÄÀàÒ²ÊÇ×ñÊØÕâ¸ö¹æ·¶µÄ¡£
    Í¨¹ýÀà·½·¨´´½¨µÄ¶ÔÏó¶¼ÊÇÒÑ¾­±»autorelease¹ýµÄÁË¡£
    ËùÒÔ£¬ÎÒÃÇÒ²Òª×ñÊØÕâ¸ö¹æ·¶£¬ Àà·½·¨·µ»ØµÄ¶ÔÏóÒ²Òª±»autorelease¹ý¡£
    ÒÔºó£¬ÎÒÃÇ·²ÊÂ´´½¨¶ÔÏóÊÇµ÷ÓÃÀà·½·¨´´½¨µÄ¶ÔÏó Õâ¸ö¶ÔÏóÒÑ¾­ÊÇ±»autorelease¹ýµÄÁË¡£


 ¡ù Ê¹ÓÃ×¢Òâ
    1).Ö»ÓÐÔÚ×Ô¶¯ÊÍ·Å³ØÖÐµ÷ÓÃÁË¶ÔÏóµÄautorelease·½·¨£¬Õâ¸ö¶ÔÏó²Å»á±»´æ´¢µ½Õâ¸ö×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ¡£
       Èç¹ûÖ»ÊÇ½«¶ÔÏóµÄ´´½¨´úÂëÐ´ÔÚ×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ£¬¶øÃ»ÓÐµ÷ÓÃ¶ÔÏóµÄautorelease·½·¨£¬ÊÇ²»»á½«Õâ¸ö¶ÔÏó´æ´¢µ½
       Õâ¸ö×Ô¶¯ÊÍ·Å³ØÖ®ÖÐµÄ¡£
  
    2).¶ÔÏóµÄ´´½¨¿ÉÒÔÔÚ×Ô¶¯ÊÍ·Å³ØÍâÃæ£¬ÔÚ×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ£¬µ÷ÓÃ¶ÔÏóµÄautorelease·½·¨£¬¾Í¿ÉÒÔ½«Õâ¸ö¶ÔÏó´æ´¢µ½
       ×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ
  
    3).Èç¹û¶ÔÏóµÄautorelease·½·¨µÄµ÷ÓÃ·ÅÔÚ×Ô¶¯ÊÍ·Å³ØµÄÍâÃæ£¬ÊÇÎÞ·¨½«Æä´æ´¢µÄÕâ¸ö×Ô¶¯ÊÍ·Å³ØÖ®ÖÐµÄ¡£
       autorelease µÄµ÷ÓÃÖ»ÓÐ·ÅÔÚ×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ ²Å¿ÉÒÔ½«Æä´æ´¢µ½×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ£¬¶ÔÏóµÄ´´½¨¿ÉÒÔÔÚÍâÃæ
  
    4).µ±×Ô¶¯ÊÍ·Å³Ø½áÊøµÄÊ±ºò£¬½ö½öÊÇ¶Ô´æ´¢ÔÚ×Ô¶¯ÊÍ·Å³ØÖÐµÄ¶ÔÏó·¢ËÍ1ÌõreleaseÏûÏ¢ ¶ø²»ÊÇÏú»Ù¶ÔÏó¡£

    5).Èç¹ûÔÚ×Ô¶¯ÊÍ·Å³ØÖÐ£¬µ÷ÓÃÍ¬1¸ö¶ÔÏóµÄautorelease·½·¨¶à´Î£¬¾Í»á½«¶ÔÏó´æ´¢¶à´Îµ½×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ¡£
       ÔÚ×Ô¶¯ÊÍ·Å³Ø½áÊøµÄÊ±ºò£¬»áÎª¶ÔÏó·¢ËÍ¶àÌõreleaseÏûÏ¢£¬ÄÇÃ´Õâ¸öÊ±ºò¾Í»á³öÏÖ½©Ê¬¶ÔÏó´íÎó¡£
       ËùÒÔ£¬1¸ö×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ£¬autoreleaseÒ»´Î£¬¾Í½«Õâ¸ö¶ÔÏóÊÍ·ÅÒ»´Î£¬·ñÔò¾Í»á³öÏÖÒ°Ö¸Õë´íÎó¡£

    6).Èç¹ûÔÚ×Ô¶¯ÊÍ·Å³ØÖÐ£¬µ÷ÓÃÁË´æ´¢µ½×Ô¶¯ÊÍ·Å³ØÖÐµÄ¶ÔÏóµÄrelease·½·¨¡£
       ÔÚ×Ô¶¯ÊÍ·Å³Ø½áÊøµÄÊ±ºò£¬»¹»áÔÙµ÷ÓÃ¶ÔÏóµÄreleas·½·¨¡£
       Õâ¸öÊ±ºò¾ÍÓÐ¿ÉÄÜÔì³ÉÒ°Ö¸Õë²Ù×÷
       Ò²¿ÉÒÔµ÷ÓÃ´æ´¢ÔÚ×Ô¶¯ÊÍ·Å³ØÖÐµÄ¶ÔÏóµÄretain·½·¨¡£

    7).½«¶ÔÏó´æ´¢µ½×Ô¶¯ÊÍ·Å³Ø£¬²¢²»»áÊ¹¶ÔÏóµÄÒýÓÃ¼ÆÊýÆ÷+1
       ËùÒÔÆäºÃ´¦¾ÍÊÇ£º´´½¨¶ÔÏó½«¶ÔÏó´æ´¢ÔÚ×Ô¶¯ÊÍ·Å³Ø£¬¾Í²»ÐèÒªÔÚÐ´¸öreleaseÁË¡£
     
    8).×Ô¶¯ÊÍ·Å³Ø¿ÉÒÔÇ¶Ì×
       µ÷ÓÃ¶ÔÏóµÄautorelease·½·¨£¬»á½«¶ÔÏó¼ÓÈëµ½µ±Ç°×Ô¶¯ÊÍ·Å³ØÖ®ÖÐ
       Ö»ÓÐÔÚµ±Ç°×Ô¶¯ÊÍ·Å³Ø½áÊøµÄÊ±ºò²Å»áÏñ¶ÔÏó·¢ËÍreleaseÏûÏ¢¡£
  
 
--------------------------------------------------------------------------------------------------------

